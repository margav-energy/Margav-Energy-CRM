{"ast":null,"code":"import React,{useState,useEffect}from'react';import{dialerAPI}from'../api';import{toast}from'react-toastify';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AdminDialerControl=()=>{const[dialer,setDialer]=useState(null);const[loading,setLoading]=useState(true);const[updating,setUpdating]=useState(false);useEffect(()=>{fetchDialerStatus();},[]);const fetchDialerStatus=async()=>{try{setLoading(true);const dialerData=await dialerAPI.getDialerStatus();setDialer(dialerData);}catch(error){console.error('Failed to fetch dialer status:',error);toast.error('Failed to fetch dialer status');}finally{setLoading(false);}};const toggleDialer=async()=>{if(!dialer)return;try{setUpdating(true);const newStatus=!dialer.is_active;const updatedDialer=await dialerAPI.updateDialerStatus(newStatus);setDialer(updatedDialer);if(newStatus){toast.success('Dialer activated! Calls will now be distributed to agents.');}else{toast.info('Dialer deactivated. No new calls will be distributed.');}}catch(error){console.error('Failed to update dialer status:',error);toast.error('Failed to update dialer status');}finally{setUpdating(false);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"card-margav p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"animate-pulse\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-6 bg-gray-200 rounded w-1/3 mb-4\"}),/*#__PURE__*/_jsx(\"div\",{className:\"h-4 bg-gray-200 rounded w-2/3\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"card-margav p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-gray-900\",children:\"Dialer Control\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:\"Control the call distribution system\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"px-3 py-1 rounded-full text-sm font-medium \".concat(dialer!==null&&dialer!==void 0&&dialer.is_active?'bg-green-100 text-green-800':'bg-gray-100 text-gray-800'),children:dialer!==null&&dialer!==void 0&&dialer.is_active?'Active':'Inactive'}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleDialer,disabled:updating,className:\"px-6 py-2 rounded-lg font-medium transition-all duration-200 \".concat(dialer!==null&&dialer!==void 0&&dialer.is_active?'bg-red-500 hover:bg-red-600 text-white':'bg-green-500 hover:bg-green-600 text-white',\" disabled:opacity-50 disabled:cursor-not-allowed\"),children:updating?/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"}),\"Updating...\"]}):dialer!==null&&dialer!==void 0&&dialer.is_active?'Deactivate':'Activate'})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-2\",children:\"How it works:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-sm text-gray-600 space-y-1\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 When \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-green-600\",children:\"Active\"}),\": Calls are automatically distributed to available agents\"]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2022 When \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-gray-600\",children:\"Inactive\"}),\": No new calls are distributed\"]}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Agents receive cold call leads when the dialer is active\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Agents can update lead disposition after each call\"})]})]}),dialer&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 text-xs text-gray-500\",children:[\"Last updated: \",new Date(dialer.updated_at).toLocaleString()]})]});};export default AdminDialerControl;","map":{"version":3,"names":["React","useState","useEffect","dialerAPI","toast","jsx","_jsx","jsxs","_jsxs","AdminDialerControl","dialer","setDialer","loading","setLoading","updating","setUpdating","fetchDialerStatus","dialerData","getDialerStatus","error","console","toggleDialer","newStatus","is_active","updatedDialer","updateDialerStatus","success","info","className","children","concat","onClick","disabled","Date","updated_at","toLocaleString"],"sources":["/Users/elarh/Desktop/Margav Energy CRM/frontend/src/components/AdminDialerControl.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Dialer } from '../types';\nimport { dialerAPI } from '../api';\nimport { toast } from 'react-toastify';\n\nconst AdminDialerControl: React.FC = () => {\n  const [dialer, setDialer] = useState<Dialer | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [updating, setUpdating] = useState(false);\n\n  useEffect(() => {\n    fetchDialerStatus();\n  }, []);\n\n  const fetchDialerStatus = async () => {\n    try {\n      setLoading(true);\n      const dialerData = await dialerAPI.getDialerStatus();\n      setDialer(dialerData);\n    } catch (error) {\n      console.error('Failed to fetch dialer status:', error);\n      toast.error('Failed to fetch dialer status');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const toggleDialer = async () => {\n    if (!dialer) return;\n\n    try {\n      setUpdating(true);\n      const newStatus = !dialer.is_active;\n      const updatedDialer = await dialerAPI.updateDialerStatus(newStatus);\n      setDialer(updatedDialer);\n      \n      if (newStatus) {\n        toast.success('Dialer activated! Calls will now be distributed to agents.');\n      } else {\n        toast.info('Dialer deactivated. No new calls will be distributed.');\n      }\n    } catch (error) {\n      console.error('Failed to update dialer status:', error);\n      toast.error('Failed to update dialer status');\n    } finally {\n      setUpdating(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"card-margav p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-6 bg-gray-200 rounded w-1/3 mb-4\"></div>\n          <div className=\"h-4 bg-gray-200 rounded w-2/3\"></div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"card-margav p-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <div>\n          <h3 className=\"text-xl font-semibold text-gray-900\">Dialer Control</h3>\n          <p className=\"text-sm text-gray-600 mt-1\">\n            Control the call distribution system\n          </p>\n        </div>\n        <div className=\"flex items-center space-x-3\">\n          <div className={`px-3 py-1 rounded-full text-sm font-medium ${\n            dialer?.is_active \n              ? 'bg-green-100 text-green-800' \n              : 'bg-gray-100 text-gray-800'\n          }`}>\n            {dialer?.is_active ? 'Active' : 'Inactive'}\n          </div>\n          <button\n            onClick={toggleDialer}\n            disabled={updating}\n            className={`px-6 py-2 rounded-lg font-medium transition-all duration-200 ${\n              dialer?.is_active\n                ? 'bg-red-500 hover:bg-red-600 text-white'\n                : 'bg-green-500 hover:bg-green-600 text-white'\n            } disabled:opacity-50 disabled:cursor-not-allowed`}\n          >\n            {updating ? (\n              <div className=\"flex items-center\">\n                <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n                Updating...\n              </div>\n            ) : (\n              dialer?.is_active ? 'Deactivate' : 'Activate'\n            )}\n          </button>\n        </div>\n      </div>\n\n      <div className=\"bg-gray-50 rounded-lg p-4\">\n        <h4 className=\"font-medium text-gray-900 mb-2\">How it works:</h4>\n        <ul className=\"text-sm text-gray-600 space-y-1\">\n          <li>• When <span className=\"font-semibold text-green-600\">Active</span>: Calls are automatically distributed to available agents</li>\n          <li>• When <span className=\"font-semibold text-gray-600\">Inactive</span>: No new calls are distributed</li>\n          <li>• Agents receive cold call leads when the dialer is active</li>\n          <li>• Agents can update lead disposition after each call</li>\n        </ul>\n      </div>\n\n      {dialer && (\n        <div className=\"mt-4 text-xs text-gray-500\">\n          Last updated: {new Date(dialer.updated_at).toLocaleString()}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AdminDialerControl;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}