{"ast":null,"code":"var _jsxFileName = \"/Users/elarh/Desktop/Margav Energy CRM/frontend/src/components/KanbanBoard.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { leadsAPI } from '../api';\nimport { toast } from 'react-toastify';\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, useSensor, useSensors, DragOverlay } from '@dnd-kit/core';\nimport { SortableContext, sortableKeyboardCoordinates, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SortableLeadCard = ({\n  lead,\n  getStatusBadgeColor,\n  getStatusDisplayName,\n  formatDate\n}) => {\n  _s();\n  // Safety check for lead data\n  if (!lead || typeof lead.id === 'undefined') {\n    console.warn('SortableLeadCard received invalid lead data:', lead);\n    return null;\n  }\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging\n  } = useSortable({\n    id: lead.id.toString()\n  });\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.5 : 1\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: setNodeRef,\n    style: style,\n    ...attributes,\n    ...listeners,\n    className: \"bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-start justify-between mb-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-medium text-gray-900 text-sm\",\n        children: lead.full_name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: `px-2 py-1 rounded-full text-xs font-medium ${getStatusBadgeColor(lead.status)}`,\n        children: getStatusDisplayName(lead.status)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-1 text-xs text-gray-600\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\uD83D\\uDCDE \", lead.phone]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }, this), lead.email && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\uD83D\\uDCE7 \", lead.email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 24\n      }, this), lead.appointment_date && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\uD83D\\uDCC5 \", formatDate(lead.appointment_date)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), lead.sale_amount && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"font-semibold text-green-600\",\n        children: [\"\\uD83D\\uDCB0 $\", lead.sale_amount.toLocaleString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }, this), lead.notes && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-xs text-gray-500 mt-2 line-clamp-2\",\n      children: lead.notes\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2 text-xs text-gray-400\",\n      children: [\"Assigned to: \", lead.assigned_agent_name || lead.assigned_agent_username]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n_s(SortableLeadCard, \"iTIyvp0X9kMGpdHRsWsr2+tGbVI=\", false, function () {\n  return [useSortable];\n});\n_c = SortableLeadCard;\nconst KanbanBoard = ({\n  userRole\n}) => {\n  _s2();\n  var _columns$flatMap$find;\n  const [columns, setColumns] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [activeId, setActiveId] = useState(null);\n  const sensors = useSensors(useSensor(PointerSensor), useSensor(KeyboardSensor, {\n    coordinateGetter: sortableKeyboardCoordinates\n  }));\n  useEffect(() => {\n    fetchLeads();\n  }, [userRole]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const fetchLeads = async () => {\n    try {\n      setLoading(true);\n      const response = await leadsAPI.getLeads();\n      const leads = response.results;\n\n      // Define columns based on user role\n      let columnDefinitions = [];\n      if (userRole === 'admin') {\n        columnDefinitions = [{\n          id: 'cold_call',\n          title: 'Cold Calls',\n          statuses: ['cold_call'],\n          color: 'bg-gray-100'\n        }, {\n          id: 'interested',\n          title: 'Interested',\n          statuses: ['sent_to_kelly'],\n          color: 'bg-blue-100'\n        }, {\n          id: 'qualified',\n          title: 'Qualified',\n          statuses: ['qualified'],\n          color: 'bg-green-100'\n        }, {\n          id: 'appointments',\n          title: 'Appointments',\n          statuses: ['appointment_set'],\n          color: 'bg-purple-100'\n        }, {\n          id: 'completed',\n          title: 'Completed',\n          statuses: ['appointment_completed'],\n          color: 'bg-yellow-100'\n        }, {\n          id: 'sales',\n          title: 'Sales',\n          statuses: ['sale_made', 'sale_lost'],\n          color: 'bg-indigo-100'\n        }];\n      } else if (userRole === 'agent') {\n        columnDefinitions = [{\n          id: 'cold_call',\n          title: 'Cold Calls',\n          statuses: ['cold_call'],\n          color: 'bg-gray-100'\n        }, {\n          id: 'interested',\n          title: 'Interested',\n          statuses: ['interested'],\n          color: 'bg-blue-100'\n        }, {\n          id: 'sent_to_kelly',\n          title: 'Sent to Kelly',\n          statuses: ['sent_to_kelly'],\n          color: 'bg-green-100'\n        }, {\n          id: 'not_interested',\n          title: 'Not Interested',\n          statuses: ['not_interested', 'tenant', 'other_disposition'],\n          color: 'bg-red-100'\n        }];\n      } else if (userRole === 'qualifier') {\n        columnDefinitions = [{\n          id: 'sent_to_kelly',\n          title: 'To Qualify',\n          statuses: ['sent_to_kelly'],\n          color: 'bg-blue-100'\n        }, {\n          id: 'qualified',\n          title: 'Qualified',\n          statuses: ['qualified'],\n          color: 'bg-green-100'\n        }, {\n          id: 'appointments',\n          title: 'Appointments Set',\n          statuses: ['appointment_set'],\n          color: 'bg-purple-100'\n        }, {\n          id: 'not_qualified',\n          title: 'Not Qualified',\n          statuses: ['not_interested', 'no_contact', 'blow_out', 'callback', 'pass_back_to_agent'],\n          color: 'bg-red-100'\n        }];\n      } else if (userRole === 'salesrep') {\n        columnDefinitions = [{\n          id: 'appointments',\n          title: 'My Appointments',\n          statuses: ['appointment_set'],\n          color: 'bg-purple-100'\n        }, {\n          id: 'completed',\n          title: 'Completed',\n          statuses: ['appointment_completed'],\n          color: 'bg-yellow-100'\n        }, {\n          id: 'sales',\n          title: 'Sales Results',\n          statuses: ['sale_made', 'sale_lost'],\n          color: 'bg-indigo-100'\n        }];\n      }\n\n      // Populate columns with leads\n      const populatedColumns = columnDefinitions.map(column => ({\n        ...column,\n        leads: leads.filter(lead => column.statuses.includes(lead.status))\n      }));\n      setColumns(populatedColumns);\n    } catch (error) {\n      console.error('Failed to fetch leads:', error);\n      toast.error('Failed to fetch leads');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const getStatusBadgeColor = status => {\n    const colors = {\n      'cold_call': 'bg-gray-100 text-gray-800',\n      'interested': 'bg-blue-100 text-blue-800',\n      'sent_to_kelly': 'bg-green-100 text-green-800',\n      'qualified': 'bg-green-100 text-green-800',\n      'appointment_set': 'bg-purple-100 text-purple-800',\n      'appointment_completed': 'bg-yellow-100 text-yellow-800',\n      'sale_made': 'bg-green-100 text-green-800',\n      'sale_lost': 'bg-red-100 text-red-800',\n      'not_interested': 'bg-red-100 text-red-800',\n      'tenant': 'bg-orange-100 text-orange-800',\n      'other_disposition': 'bg-gray-100 text-gray-800',\n      'no_contact': 'bg-gray-100 text-gray-800',\n      'blow_out': 'bg-red-100 text-red-800',\n      'callback': 'bg-yellow-100 text-yellow-800',\n      'pass_back_to_agent': 'bg-blue-100 text-blue-800'\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n  const getStatusDisplayName = status => {\n    const names = {\n      'cold_call': 'Cold Call',\n      'interested': 'Interested',\n      'sent_to_kelly': 'Sent to Kelly',\n      'qualified': 'Qualified',\n      'appointment_set': 'Appointment Set',\n      'appointment_completed': 'Completed',\n      'sale_made': 'Sale Made',\n      'sale_lost': 'Sale Lost',\n      'not_interested': 'Not Interested',\n      'tenant': 'Tenant',\n      'other_disposition': 'Other',\n      'no_contact': 'No Contact',\n      'blow_out': 'Blow Out',\n      'callback': 'Call Back',\n      'pass_back_to_agent': 'Pass Back'\n    };\n    return names[status] || status;\n  };\n  const formatDate = dateString => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  const handleDragStart = event => {\n    setActiveId(event.active.id);\n  };\n  const handleDragEnd = async event => {\n    const {\n      active,\n      over\n    } = event;\n    setActiveId(null);\n    if (!over) return;\n    const activeId = active.id;\n    const overId = over.id;\n\n    // Find the source column and lead\n    let sourceColumn = null;\n    let sourceLead = null;\n    for (const column of columns) {\n      const leadIndex = column.leads.findIndex(lead => lead.id.toString() === activeId);\n      if (leadIndex !== -1) {\n        sourceColumn = column;\n        sourceLead = column.leads[leadIndex];\n        break;\n      }\n    }\n    if (!sourceColumn || !sourceLead) return;\n\n    // Find the target column\n    let targetColumn = null;\n    for (const column of columns) {\n      if (column.id === overId || column.leads.some(lead => lead.id.toString() === overId)) {\n        targetColumn = column;\n        break;\n      }\n    }\n    if (!targetColumn || sourceColumn.id === targetColumn.id) return;\n\n    // Determine new status based on target column\n    let newStatus = sourceLead.status;\n    if (targetColumn.statuses.length > 0) {\n      newStatus = targetColumn.statuses[0];\n    }\n\n    // Update the lead status in the backend\n    try {\n      let updatedLead;\n\n      // Use different API endpoints based on user role\n      if (userRole === 'qualifier' && sourceLead.status === 'sent_to_kelly') {\n        // For qualifiers, use the qualify endpoint\n        updatedLead = await leadsAPI.qualifyLead(sourceLead.id, {\n          status: newStatus\n        });\n      } else {\n        // For other roles, use the regular update endpoint\n        updatedLead = await leadsAPI.updateLead(sourceLead.id, {\n          status: newStatus\n        });\n      }\n\n      // Update local state\n      setColumns(prevColumns => {\n        const newColumns = [...prevColumns];\n\n        // Remove from source column\n        const sourceColIndex = newColumns.findIndex(col => col.id === sourceColumn.id);\n        newColumns[sourceColIndex] = {\n          ...newColumns[sourceColIndex],\n          leads: newColumns[sourceColIndex].leads.filter(lead => lead.id.toString() !== activeId)\n        };\n\n        // Add to target column\n        const targetColIndex = newColumns.findIndex(col => col.id === targetColumn.id);\n        const leadToAdd = updatedLead || {\n          ...sourceLead,\n          status: newStatus\n        };\n        newColumns[targetColIndex] = {\n          ...newColumns[targetColIndex],\n          leads: [...newColumns[targetColIndex].leads, leadToAdd]\n        };\n        return newColumns;\n      });\n      toast.success(`Lead moved to ${targetColumn.title}`);\n    } catch (error) {\n      console.error('Failed to update lead status:', error);\n      toast.error('Failed to update lead status');\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center items-center h-64\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"space-y-6\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-between items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent\",\n        children: \"Lead Pipeline - Kanban Board\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: fetchLeads,\n        className: \"btn-margav-secondary\",\n        children: \"Refresh\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DndContext, {\n      sensors: sensors,\n      collisionDetection: closestCenter,\n      onDragStart: handleDragStart,\n      onDragEnd: handleDragEnd,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"overflow-x-auto\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-3 min-w-max pb-4\",\n          children: columns.map(column => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-shrink-0 w-64 lg:w-72\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `${column.color} rounded-lg p-4 h-full min-h-[500px]`,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center justify-between mb-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  className: \"font-semibold text-gray-900 text-sm lg:text-base\",\n                  children: column.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 352,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"bg-white bg-opacity-50 text-gray-700 px-2 py-1 rounded-full text-xs font-medium\",\n                  children: column.leads.length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 353,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 351,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(SortableContext, {\n                items: column.leads.map(lead => {\n                  var _lead$id;\n                  return ((_lead$id = lead.id) === null || _lead$id === void 0 ? void 0 : _lead$id.toString()) || '';\n                }),\n                strategy: verticalListSortingStrategy,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2 max-h-[calc(100vh-400px)] overflow-y-auto\",\n                  children: column.leads.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"text-center py-6 text-gray-500\",\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"text-3xl mb-2\",\n                      children: \"\\uD83D\\uDCCB\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 365,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs\",\n                      children: \"No leads\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 366,\n                      columnNumber: 27\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 364,\n                    columnNumber: 25\n                  }, this) : column.leads.map(lead => {\n                    var _lead$id2;\n                    return /*#__PURE__*/_jsxDEV(SortableLeadCard, {\n                      lead: lead,\n                      getStatusBadgeColor: getStatusBadgeColor,\n                      getStatusDisplayName: getStatusDisplayName,\n                      formatDate: formatDate\n                    }, ((_lead$id2 = lead.id) === null || _lead$id2 === void 0 ? void 0 : _lead$id2.toString()) || `lead-${Math.random()}`, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 370,\n                      columnNumber: 27\n                    }, this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 362,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 358,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 350,\n              columnNumber: 17\n            }, this)\n          }, column.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 349,\n            columnNumber: 15\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 347,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(DragOverlay, {\n        children: activeId ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-white rounded-lg p-4 shadow-lg border-2 border-green-500 opacity-90\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm font-medium text-gray-900\",\n            children: (_columns$flatMap$find = columns.flatMap(col => col.leads).find(lead => lead.id.toString() === activeId)) === null || _columns$flatMap$find === void 0 ? void 0 : _columns$flatMap$find.full_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 13\n        }, this) : null\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 387,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 327,\n    columnNumber: 5\n  }, this);\n};\n_s2(KanbanBoard, \"hWOfGwTJ/RU/nIl4AyLzm6x+jWY=\", false, function () {\n  return [useSensors, useSensor, useSensor];\n});\n_c2 = KanbanBoard;\nexport default KanbanBoard;\nvar _c, _c2;\n$RefreshReg$(_c, \"SortableLeadCard\");\n$RefreshReg$(_c2, \"KanbanBoard\");","map":{"version":3,"names":["React","useState","useEffect","leadsAPI","toast","DndContext","closestCenter","KeyboardSensor","PointerSensor","useSensor","useSensors","DragOverlay","SortableContext","sortableKeyboardCoordinates","verticalListSortingStrategy","useSortable","CSS","jsxDEV","_jsxDEV","SortableLeadCard","lead","getStatusBadgeColor","getStatusDisplayName","formatDate","_s","id","console","warn","attributes","listeners","setNodeRef","transform","transition","isDragging","toString","style","Transform","opacity","ref","className","children","full_name","fileName","_jsxFileName","lineNumber","columnNumber","status","phone","email","appointment_date","sale_amount","toLocaleString","notes","assigned_agent_name","assigned_agent_username","_c","KanbanBoard","userRole","_s2","_columns$flatMap$find","columns","setColumns","loading","setLoading","activeId","setActiveId","sensors","coordinateGetter","fetchLeads","response","getLeads","leads","results","columnDefinitions","title","statuses","color","populatedColumns","map","column","filter","includes","error","colors","names","dateString","Date","toLocaleDateString","month","day","hour","minute","handleDragStart","event","active","handleDragEnd","over","overId","sourceColumn","sourceLead","leadIndex","findIndex","targetColumn","some","newStatus","length","updatedLead","qualifyLead","updateLead","prevColumns","newColumns","sourceColIndex","col","targetColIndex","leadToAdd","success","onClick","collisionDetection","onDragStart","onDragEnd","items","_lead$id","strategy","_lead$id2","Math","random","flatMap","find","_c2","$RefreshReg$"],"sources":["/Users/elarh/Desktop/Margav Energy CRM/frontend/src/components/KanbanBoard.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Lead } from '../types';\nimport { leadsAPI } from '../api';\nimport { toast } from 'react-toastify';\nimport {\n  DndContext,\n  closestCenter,\n  KeyboardSensor,\n  PointerSensor,\n  useSensor,\n  useSensors,\n  DragEndEvent,\n  DragOverlay,\n  DragStartEvent,\n} from '@dnd-kit/core';\nimport {\n  SortableContext,\n  sortableKeyboardCoordinates,\n  verticalListSortingStrategy,\n} from '@dnd-kit/sortable';\nimport {\n  useSortable,\n} from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\n\ninterface KanbanBoardProps {\n  userRole: string;\n}\n\ninterface KanbanColumn {\n  id: string;\n  title: string;\n  statuses: string[];\n  color: string;\n  leads: Lead[];\n}\n\ninterface SortableLeadCardProps {\n  lead: Lead;\n  getStatusBadgeColor: (status: string) => string;\n  getStatusDisplayName: (status: string) => string;\n  formatDate: (dateString: string) => string;\n}\n\nconst SortableLeadCard: React.FC<SortableLeadCardProps> = ({\n  lead,\n  getStatusBadgeColor,\n  getStatusDisplayName,\n  formatDate,\n}) => {\n  // Safety check for lead data\n  if (!lead || typeof lead.id === 'undefined') {\n    console.warn('SortableLeadCard received invalid lead data:', lead);\n    return null;\n  }\n\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging,\n  } = useSortable({ id: lead.id.toString() });\n\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.5 : 1,\n  };\n\n  return (\n    <div\n      ref={setNodeRef}\n      style={style}\n      {...attributes}\n      {...listeners}\n      className=\"bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-grab active:cursor-grabbing\"\n    >\n      <div className=\"flex items-start justify-between mb-2\">\n        <h4 className=\"font-medium text-gray-900 text-sm\">{lead.full_name}</h4>\n        <span className={`px-2 py-1 rounded-full text-xs font-medium ${getStatusBadgeColor(lead.status)}`}>\n          {getStatusDisplayName(lead.status)}\n        </span>\n      </div>\n      \n      <div className=\"space-y-1 text-xs text-gray-600\">\n        <p>ðŸ“ž {lead.phone}</p>\n        {lead.email && <p>ðŸ“§ {lead.email}</p>}\n        {lead.appointment_date && (\n          <p>ðŸ“… {formatDate(lead.appointment_date)}</p>\n        )}\n        {lead.sale_amount && (\n          <p className=\"font-semibold text-green-600\">ðŸ’° ${lead.sale_amount.toLocaleString()}</p>\n        )}\n      </div>\n      \n      {lead.notes && (\n        <p className=\"text-xs text-gray-500 mt-2 line-clamp-2\">{lead.notes}</p>\n      )}\n      \n      <div className=\"mt-2 text-xs text-gray-400\">\n        Assigned to: {lead.assigned_agent_name || lead.assigned_agent_username}\n      </div>\n    </div>\n  );\n};\n\nconst KanbanBoard: React.FC<KanbanBoardProps> = ({ userRole }) => {\n  const [columns, setColumns] = useState<KanbanColumn[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [activeId, setActiveId] = useState<string | null>(null);\n\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  useEffect(() => {\n    fetchLeads();\n  }, [userRole]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const fetchLeads = async () => {\n    try {\n      setLoading(true);\n      const response = await leadsAPI.getLeads();\n      const leads = response.results;\n      \n      // Define columns based on user role\n      let columnDefinitions: Omit<KanbanColumn, 'leads'>[] = [];\n      \n      if (userRole === 'admin') {\n        columnDefinitions = [\n          { id: 'cold_call', title: 'Cold Calls', statuses: ['cold_call'], color: 'bg-gray-100' },\n          { id: 'interested', title: 'Interested', statuses: ['sent_to_kelly'], color: 'bg-blue-100' },\n          { id: 'qualified', title: 'Qualified', statuses: ['qualified'], color: 'bg-green-100' },\n          { id: 'appointments', title: 'Appointments', statuses: ['appointment_set'], color: 'bg-purple-100' },\n          { id: 'completed', title: 'Completed', statuses: ['appointment_completed'], color: 'bg-yellow-100' },\n          { id: 'sales', title: 'Sales', statuses: ['sale_made', 'sale_lost'], color: 'bg-indigo-100' },\n        ];\n      } else if (userRole === 'agent') {\n        columnDefinitions = [\n          { id: 'cold_call', title: 'Cold Calls', statuses: ['cold_call'], color: 'bg-gray-100' },\n          { id: 'interested', title: 'Interested', statuses: ['interested'], color: 'bg-blue-100' },\n          { id: 'sent_to_kelly', title: 'Sent to Kelly', statuses: ['sent_to_kelly'], color: 'bg-green-100' },\n          { id: 'not_interested', title: 'Not Interested', statuses: ['not_interested', 'tenant', 'other_disposition'], color: 'bg-red-100' },\n        ];\n      } else if (userRole === 'qualifier') {\n        columnDefinitions = [\n          { id: 'sent_to_kelly', title: 'To Qualify', statuses: ['sent_to_kelly'], color: 'bg-blue-100' },\n          { id: 'qualified', title: 'Qualified', statuses: ['qualified'], color: 'bg-green-100' },\n          { id: 'appointments', title: 'Appointments Set', statuses: ['appointment_set'], color: 'bg-purple-100' },\n          { id: 'not_qualified', title: 'Not Qualified', statuses: ['not_interested', 'no_contact', 'blow_out', 'callback', 'pass_back_to_agent'], color: 'bg-red-100' },\n        ];\n      } else if (userRole === 'salesrep') {\n        columnDefinitions = [\n          { id: 'appointments', title: 'My Appointments', statuses: ['appointment_set'], color: 'bg-purple-100' },\n          { id: 'completed', title: 'Completed', statuses: ['appointment_completed'], color: 'bg-yellow-100' },\n          { id: 'sales', title: 'Sales Results', statuses: ['sale_made', 'sale_lost'], color: 'bg-indigo-100' },\n        ];\n      }\n\n      // Populate columns with leads\n      const populatedColumns = columnDefinitions.map(column => ({\n        ...column,\n        leads: leads.filter(lead => column.statuses.includes(lead.status))\n      }));\n\n      setColumns(populatedColumns);\n    } catch (error) {\n      console.error('Failed to fetch leads:', error);\n      toast.error('Failed to fetch leads');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getStatusBadgeColor = (status: string) => {\n    const colors: { [key: string]: string } = {\n      'cold_call': 'bg-gray-100 text-gray-800',\n      'interested': 'bg-blue-100 text-blue-800',\n      'sent_to_kelly': 'bg-green-100 text-green-800',\n      'qualified': 'bg-green-100 text-green-800',\n      'appointment_set': 'bg-purple-100 text-purple-800',\n      'appointment_completed': 'bg-yellow-100 text-yellow-800',\n      'sale_made': 'bg-green-100 text-green-800',\n      'sale_lost': 'bg-red-100 text-red-800',\n      'not_interested': 'bg-red-100 text-red-800',\n      'tenant': 'bg-orange-100 text-orange-800',\n      'other_disposition': 'bg-gray-100 text-gray-800',\n      'no_contact': 'bg-gray-100 text-gray-800',\n      'blow_out': 'bg-red-100 text-red-800',\n      'callback': 'bg-yellow-100 text-yellow-800',\n      'pass_back_to_agent': 'bg-blue-100 text-blue-800',\n    };\n    return colors[status] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getStatusDisplayName = (status: string) => {\n    const names: { [key: string]: string } = {\n      'cold_call': 'Cold Call',\n      'interested': 'Interested',\n      'sent_to_kelly': 'Sent to Kelly',\n      'qualified': 'Qualified',\n      'appointment_set': 'Appointment Set',\n      'appointment_completed': 'Completed',\n      'sale_made': 'Sale Made',\n      'sale_lost': 'Sale Lost',\n      'not_interested': 'Not Interested',\n      'tenant': 'Tenant',\n      'other_disposition': 'Other',\n      'no_contact': 'No Contact',\n      'blow_out': 'Blow Out',\n      'callback': 'Call Back',\n      'pass_back_to_agent': 'Pass Back',\n    };\n    return names[status] || status;\n  };\n\n  const formatDate = (dateString: string) => {\n    return new Date(dateString).toLocaleDateString('en-US', {\n      month: 'short',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  const handleDragStart = (event: DragStartEvent) => {\n    setActiveId(event.active.id as string);\n  };\n\n  const handleDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveId(null);\n\n    if (!over) return;\n\n    const activeId = active.id as string;\n    const overId = over.id as string;\n\n    // Find the source column and lead\n    let sourceColumn: KanbanColumn | null = null;\n    let sourceLead: Lead | null = null;\n\n    for (const column of columns) {\n      const leadIndex = column.leads.findIndex(lead => lead.id.toString() === activeId);\n      if (leadIndex !== -1) {\n        sourceColumn = column;\n        sourceLead = column.leads[leadIndex];\n        break;\n      }\n    }\n\n    if (!sourceColumn || !sourceLead) return;\n\n    // Find the target column\n    let targetColumn: KanbanColumn | null = null;\n    for (const column of columns) {\n      if (column.id === overId || column.leads.some(lead => lead.id.toString() === overId)) {\n        targetColumn = column;\n        break;\n      }\n    }\n\n    if (!targetColumn || sourceColumn.id === targetColumn.id) return;\n\n    // Determine new status based on target column\n    let newStatus = sourceLead.status;\n    if (targetColumn.statuses.length > 0) {\n      newStatus = targetColumn.statuses[0] as Lead['status'];\n    }\n\n    // Update the lead status in the backend\n    try {\n      let updatedLead: Lead | undefined;\n      \n      // Use different API endpoints based on user role\n      if (userRole === 'qualifier' && sourceLead.status === 'sent_to_kelly') {\n        // For qualifiers, use the qualify endpoint\n        updatedLead = await leadsAPI.qualifyLead(sourceLead.id, { status: newStatus });\n      } else {\n        // For other roles, use the regular update endpoint\n        updatedLead = await leadsAPI.updateLead(sourceLead.id, { status: newStatus });\n      }\n      \n      // Update local state\n      setColumns(prevColumns => {\n        const newColumns = [...prevColumns];\n        \n        // Remove from source column\n        const sourceColIndex = newColumns.findIndex(col => col.id === sourceColumn!.id);\n        newColumns[sourceColIndex] = {\n          ...newColumns[sourceColIndex],\n          leads: newColumns[sourceColIndex].leads.filter(lead => lead.id.toString() !== activeId)\n        };\n        \n        // Add to target column\n        const targetColIndex = newColumns.findIndex(col => col.id === targetColumn!.id);\n        const leadToAdd: Lead = updatedLead || { ...sourceLead!, status: newStatus };\n        newColumns[targetColIndex] = {\n          ...newColumns[targetColIndex],\n          leads: [...newColumns[targetColIndex].leads, leadToAdd]\n        };\n        \n        return newColumns;\n      });\n\n      toast.success(`Lead moved to ${targetColumn.title}`);\n    } catch (error) {\n      console.error('Failed to update lead status:', error);\n      toast.error('Failed to update lead status');\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-2xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent\">\n          Lead Pipeline - Kanban Board\n        </h2>\n        <button\n          onClick={fetchLeads}\n          className=\"btn-margav-secondary\"\n        >\n          Refresh\n        </button>\n      </div>\n\n      <DndContext\n        sensors={sensors}\n        collisionDetection={closestCenter}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n      >\n        <div className=\"overflow-x-auto\">\n          <div className=\"flex space-x-3 min-w-max pb-4\">\n            {columns.map((column) => (\n              <div key={column.id} className=\"flex-shrink-0 w-64 lg:w-72\">\n                <div className={`${column.color} rounded-lg p-4 h-full min-h-[500px]`}>\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <h3 className=\"font-semibold text-gray-900 text-sm lg:text-base\">{column.title}</h3>\n                    <span className=\"bg-white bg-opacity-50 text-gray-700 px-2 py-1 rounded-full text-xs font-medium\">\n                      {column.leads.length}\n                    </span>\n                  </div>\n                  \n                  <SortableContext\n                    items={column.leads.map(lead => lead.id?.toString() || '')}\n                    strategy={verticalListSortingStrategy}\n                  >\n                    <div className=\"space-y-2 max-h-[calc(100vh-400px)] overflow-y-auto\">\n                      {column.leads.length === 0 ? (\n                        <div className=\"text-center py-6 text-gray-500\">\n                          <div className=\"text-3xl mb-2\">ðŸ“‹</div>\n                          <p className=\"text-xs\">No leads</p>\n                        </div>\n                      ) : (\n                        column.leads.map((lead) => (\n                          <SortableLeadCard\n                            key={lead.id?.toString() || `lead-${Math.random()}`}\n                            lead={lead}\n                            getStatusBadgeColor={getStatusBadgeColor}\n                            getStatusDisplayName={getStatusDisplayName}\n                            formatDate={formatDate}\n                          />\n                        ))\n                      )}\n                    </div>\n                  </SortableContext>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n        \n        <DragOverlay>\n          {activeId ? (\n            <div className=\"bg-white rounded-lg p-4 shadow-lg border-2 border-green-500 opacity-90\">\n              <div className=\"text-sm font-medium text-gray-900\">\n                {columns.flatMap(col => col.leads).find(lead => lead.id.toString() === activeId)?.full_name}\n              </div>\n            </div>\n          ) : null}\n        </DragOverlay>\n      </DndContext>\n    </div>\n  );\n};\n\nexport default KanbanBoard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}